{% include "base_layout.html" %}



<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        * {
        box-sizing: border-box;
        }

        .column {
            float: left;
            padding: 10px;
            height: 800px; /* Should be removed. Only for demonstration */
        }

        .left {
        width: 60%;
        }

        .right {
        width: 40%;
        }

        /* Clear floats after the columns */
        .row:after {
        content: "";
        display: table;
        clear: both;
        }


        .gameboard_grid {
            font-family: Arial, sans-serif;
        }
        table {
            border-collapse: collapse;
            margin: 20px auto;
        }
        td {
            position: relative;
            width: 120px;
            height: 120px;
            border: 1px solid black;
        }


        .cell_label {
            position: absolute;
            top: 0;
            left: 0;
            font-size: 12px;
            margin: 5px;
        }


        .circle {
            position: absolute;
            display:block;

            top: 80%;
            left: 20%;
            transform: translate(-50%, -50%);
            
            height:20px;
            width:20px;

            border-radius: 50%;
            background-color: purple;
        }

    </style>
</head>


<body>

    <h1> Clue-Less</h1>

    <div class="row">
        <div class="column left" style="background-color:#aaa;">
            <h2>Game Board</h2>

            <div class="gameboard_grid">
            <table class="gameboard_table">
                <tr>
                    <td id="Study">
                        <label class="cell_label" for="Study">Study</label><br>
                    </td>
                    <td id="Study-Hall Hall">
                        <label class="cell_label" for="Study-Hall Hall">Study-Hall Hall</label><br>
                    </td>
                    <td id="Hall">
                        <label class="cell_label" for="Hall">Hall</label><br>
                    </td>
                    <td id="Hall-Lounge Hall">
                        <label class="cell_label" for="Hall-Lounge Hall">Hall-Lounge Hall</label><br>
                    </td>
                    <td id="Lounge">
                        <label class="cell_label" for="Lounge">Lounge</label><br>
                    </td>
                </tr>
                <tr>
                    <td id="Study-Library Hall">
                        <label class="cell_label" for="Study-Library Hall">Study-Library Hall</label><br>
                    </td>
                    <td id="cell11"></td>
                    <td id="Hall-Billiard Room Hall">
                        <label class="cell_label" for="Hall-Billiard Room Hall">Hall-Billiard Room Hall</label><br>
                    </td>
                    <td id="cell13"></td>
                    <td id="Lounge-Dining Room Hall">
                        <label class="cell_label" for="Lounge-Dining Room Hall">Lounge-Dining Room Hall</label><br>
                    </td>
                </tr>
                <tr>
                    <td id="Library">
                        <label class="cell_label" for="Library">Library</label><br>
                    </td>
                    <td id="Library-Billiard Room Hall">
                        <label class="cell_label" for="Library-Billiard Room Hall">Library-Billiard Room Hall</label><br>
                    </td>
                    <td id="Billiard Room">
                        <label class="cell_label" for="Billiard Room">Billiard Room</label><br>
                    </td>
                    <td id="Billiard Room-Dining Room Hall">
                        <label class="cell_label" for="Billiard Room-Dining Room Hall">Billiard Room-Dining Room Hall</label><br>
                    </td>
                    <td id="Dining Room">
                        <label class="cell_label" for="Dining Room">Dining Room</label><br>
                    </td>
                </tr>
                <tr>
                    <td id="Library-Conservatory Hall">
                        <label class="cell_label" for="Library-Conservatory Hall">Library-Conservatory Hall</label><br>
                    </td>
                    <td id="cell31"></td>
                    <td id="Billiard Room-Ball Room Hall">
                        <label class="cell_label" for="Billiard Room-Ball Room Hall">Billiard Room-Ball Room Hall</label><br>
                    </td>
                    <td id="cell33"></td>
                    <td id="Dining Room-Kitchen Hall">
                        <label class="cell_label" for="Dining Room-Kitchen Hall">Dining Room-Kitchen Hall</label><br>
                    </td>
                </tr>
                <tr>
                    <td id="Conservatory">
                        <label class="cell_label" for="Conservatory">Conservatory</label><br>
                    </td>
                    <td id="Conservatory-Ball Room Hall">
                        <label class="cell_label" for="Conservatory-Ball Room Hall">Conservatory-Ball Room Hall</label><br>
                    </td>
                    <td id="Ball Room">
                        <label class="cell_label" for="Ball Room">Ball Room</label><br>
                    </td>
                    <td id="Ball Room-Kitchen Hall">
                        <label class="cell_label" for="Ball Room-Kitchen Hall">Ball Room-Kitchen Hall</label><br>
                    </td>
                    <td id="Kitchen">
                        <label class="cell_label" for="Kitchen">Kitchen</label><br>
                    </td>
                </tr>
            </table>
            </div>


        </div>
        <div class="column right" style="background-color:#bbb;">
            <h2 id="playerTurn">It is your turn!</h2>
            <br> 

            <div class="dispaly_char_info">
                <label>Character Name:</label>
                <input id="character_name" readonly>
                <br>
                <label>Location:</label>
                <input id="character_location" readonly>
                <br>
                <label>Cards:</label>
                <ul id="character_cards">
                    <!-- Dynamically show character's cards -->
                </ul>
                <br>
            </div>

            <br>
            <br>
            <label>What would you like to do?</label>
            <div id="display_turn_options" class="display_turn_options"><br>
                <button id="move_button" style="display: none;" onclick='ask_move()'>Move to new location</button><br>
                <button id="suggest_button" style="display: none;" onclick='ask_suggest()'>Make suggestion</button><br>
                <button onclick='ask_accusation()'>Make accusation</button>
            </div>
        

        </div>
    </div>

</body>


<script>

    function get_char_color(character_name)
    {
        var char_color = "black";
        switch(character_name){
            case "Prof. Plum":
                char_color = "purple";
                break;
            case "Mrs. Peacock":
                char_color = "blue";
                break;
        }
        return char_color;
    }

    async function load_other_character_info()
    {

    }

    async function load_my_character_info()
    {
        console.log("load_my_character_info()");

        var room_key = "{{room.room_key}}";
        var room_id = "{{room.id}}";
        var url = `/api/game/${room_id}/character/`;

        const token = document.cookie
        .split('; ')
        .find(row => row.startsWith('token='))
        .split('=')[1];
        console.log("token: ",token);

        try{
            const response = await axios.get(url, {
              headers: {
                'accept': 'application/json',
                'Authorization': `Bearer ${token}`
              }
            });
            console.log(response.data);

            // Update character display information
            const character_name = response.data["name"];
            const character_location = response.data["location"];
            const character_cards = response.data["hand"];

            document.getElementById("character_name").value = character_name;
            document.getElementById("character_location").value = character_location.name;

            const bulletList = document.getElementById('character_cards');
            character_cards.forEach(function (card_obj) {
                const li = document.createElement('li');
                li.textContent = card_obj.name;
                bulletList.appendChild(li);
            });


            // Update the character's circle color based on their name
            console.log("loc: ",character_location.name);
            console.log(document.getElementById(character_location.name));
            const cell = document.getElementById(character_location.name);
            console.log(cell)
            const characterCircle = document.createElement('div');
            characterCircle.className = 'circle';
            characterCircle.style.backgroundColor = get_char_color(character_name);
            //cell.innerHTML = ''; // Clear previous content
            cell.appendChild(characterCircle);
            

            // Update buttons of available moves during turn
            const button1 = document.getElementById('move_button');
            const button2 = document.getElementById('suggest_button');

            if (character_location.name.indexOf("-") == -1) { // currently in room
                button1.style.display = 'inline-block';
                button1.innerHTML = "Move to hallway"
                button2.style.display = 'inline-block';
                
            } else { // currently in hallway
                button1.style.display = 'inline-block';
                button1.innerHTML = "Move to room"
                button2.style.display = 'none';
            }


        } catch (error) {
            console.log(`load_my_character_info axios.post got an error: ${error}`);
        }
    }

    async function load_my_turn_options()
    {
        console.log("load_my_turn_options()");

        var room_key = "{{room.room_key}}";
        var room_id = "{{room.id}}";
        var url = `/api/game/${room_id}/character/valid_moves/`;

        const token = document.cookie
        .split('; ')
        .find(row => row.startsWith('token='))
        .split('=')[1];
        console.log("token: ",token);

        try{
            const response = await axios.post(url, null, {
              headers: {
                'accept': 'application/json',
                'Authorization': `Bearer ${token}`
              }
            });
            console.log(response.data);
        } catch (error) {
            console.log(`load_my_turn_options axios.post got an error: ${error}`);
        }

        /*
        const strings = ['Button 1', 'Button 2', 'Button 3', 'Button 4', 'Button 5'];

        function createButtons() {
            const buttonContainer = document.getElementById('buttonContainer');
            // Clear existing buttons
            buttonContainer.innerHTML = '';

            // Create a button for each string in the array
            strings.forEach(str => {
                const button = document.createElement('button');
                button.textContent = str;
                button.addEventListener('click', () => {
                    alert(`Button ${str} clicked!`);
                });
                buttonContainer.appendChild(button);
            });
        }
        */
    }


    // Do everytime we load the page
    load_my_character_info();
    load_my_turn_options();


    const drawCircle = true; // Set to true to draw a circle in each cell

    if (drawCircle) {
        const cell00 = document.getElementById('cell00');
        const circle = document.createElement('span');
        circle.classList.add('circle');
        cell00.appendChild(circle);
    }

   

</script>


<!--


    
    <div>
        <h1> Clue-Less Game Board</h1>

        <style>
            body {
                margin: 0;
                padding: 0;
                display: flex;
            }
            .left-column {
                flex: 2;
                background-color: lightblue;
                padding: 20px;
            }
            .right-column {
                flex: 3;
                background-color: lightgreen;
                padding: 20px;
            }
        </style>


        </head>
        <body>
       <!-- <div class="grid" id="grid"></div> 
        <div class="left-column">
            <h2>Left Column</h2>
            <p>This is the left column with a light blue background color.</p>
            <!--

            
            <table>
                <caption>5x5 Grid</caption>
                <tbody>
                    
                    <tr>
                        <td>1</td><td>2</td><td>3</td><td>4</td><td>5</td>
                    </tr>
                    <tr>
                        <td>6</td><td>7</td><td>8</td><td>9</td><td>10</td>
                    </tr>
                    <tr>
                        <td>11</td><td>12</td><td>13</td><td>14</td><td>15</td>
                    </tr>
                    <tr>
                        <td>16</td><td>17</td><td>18</td><td>19</td><td>20</td>
                    </tr>
                    <tr>
                        <td>21</td><td>22</td><td>23</td><td>24</td><td>25</td>
                    </tr>
                </tbody>
            </table>
        
        </div>
        <div class="right-column">
            <h2>Right Column</h2>
            <p>This is the right column with a light green background color.</p>
            <!--<input type="text" id="textbox" readonly>
        </div>
       
    </div>
    <script>

    </script>
-->
{% block body %}{% endblock %}